.fa.set-center
  .col-sm-12.avoid-this.pull-right.margin5
    %p#notice= notice
    = link_to (image_tag 'print.png'), '#', :id => "print"
    .pull-right= 'چاپ فاکتور'
    - if is_admin?
      = link_to 'ویرایش', edit_account_document_path(@account_document)
      \|
      = link_to 'بازگشت', account_documents_path
  .show-factor.fa.col-sm-12
    .header
      
      .header-img.avoid-this= image_tag 'header-small.jpg'
      .header-date
        %p.fa
          - if @account_document.payment_date.present?
            %b.header-date-title.avoid-this.col-sm-6.pull-right= 'تاریخ پرداخت'                   
            .avoid-this.col-sm-6= JalaliDate.new(@account_document.payment_date)
        %p.fa
          %b.header-date-title.avoid-this.col-sm-6.pull-right شماره فاکتور
          .show-date.col-sm-6  1234567
        %p.fa
          %b.header-date-title.avoid-this.col-sm-6.pull-right تاریخ :
          .show-date.col-sm-6= JalaliDate.new(@account_document.created_at)
        %p.fa
          %b.col-sm-6.pull-right.header-date-title.avoid-thisشماره فیزیکی فاکتور:
          .avoid-this.col-sm-6= @account_document.physical_factor_number
        .clear-float
    .body-factor
      %p.fa
        %b خریدار:
        = @account_document.paid_by
      %p.fa
        %b شرح:
        = @account_document.description
      
      .clear-float      
      %div
        %table{id:"account_table"}
          %thead
            %tr.first{:class => I18n.locale}      
              
              %th{:class => I18n.locale}       ردیف
              %th{:class => I18n.locale}       شرح کالا و خدمات
              %th{:class => I18n.locale}       تعداد
              %th{:class => I18n.locale}       فی
              %th{:class => I18n.locale}       مبلغ
              %th.avoid-this{:class => I18n.locale}       حذف
          %tbody
            - @account_document.factor_details.each_with_index do |fd, i| 
              %tr
                
                %td.fa= (i+1)
                %td.fa= fd.object_name
                %td.fa= fd.number_of
                %td.fa= fd.objecct_price
                %td.fa.object_amount= fd.object_amount
                %td.avoid-this= link_to 'حذف', fd, :method => :delete, :data => { :confirm => 'Are you sure?' }
            %tr.sum{:style => "background:#BFBFBF"}
              %th{:class => I18n.locale, :colspan=>3} جمع
              %th#first_sum{:class => I18n.locale, :colspan=>2}
            - if @account_document.takhfif_precent.present?
              %tr.sum{:class => I18n.locale}      
                %th{:class => I18n.locale, :colspan=>2} تخفیف
                %td{:class => I18n.locale, :colspan=>1}= @account_document.takhfif_precent 
                %th{:class => I18n.locale, :colspan=>2} مبلغ تخفیف
                %td{:class => I18n.locale, :colspan=>2}= @account_document.takhfif_amount 
              
                
                
            - if @account_document.installation_cost_precent.present?
              %tr
                %td.fa{:class => I18n.locale, :colspan=>2}= @account_document.installation_cost_title
                %td.fa{:class => I18n.locale, :colspan=>1}= @account_document.installation_cost_precent.to_s + '% مبلغ فوق'
                %td.fa{:class => I18n.locale, :colspan=>2, :style => "text-align:center"}= @account_document.installation_cost
            %tr.sum.bolder
              %th{:class => I18n.locale, :colspan=>3} جمع کل
              %th{:class => I18n.locale, :colspan=>2}= @account_document.value
        - if @account_document.tavajoh.present?
          .tavajoh
            %span.fa توجه:
            .fa= raw @account_document.tavajoh        
        .sign   امضا
    .factor_footer.avoid-this      
      .footer-img= image_tag 'footer-small.jpg'
  
:javascript
  $('a#print').click(function(){
    $('body').css('position', 'absolute');
    window.print();
  });
  var calculate = 0;
  $('td.object_amount').each(function() {     
    calculate += parseInt($(this).text());                     
  });
  $('#first_sum').html(calculate);
